# Katalon API - REST Assured Petstore

> **Note:** This project is part of the [Katalon AI](../README.md) unified testing framework.

## Overview

This project demonstrates REST API testing using the REST Assured library with the Swagger Petstore API. It contains automated API tests showcasing various REST API testing scenarios including:

- Pet management (create, update, delete, find by status/tags)
- Store operations (inventory, orders)
- User management (create, update, delete, login/logout)

The project demonstrates two different approaches to API testing:
1. Using REST Assured library directly
2. Using Katalon's built-in WS Keywords

## Project Structure

```
├── Object Repository/Swagger Petstore/  # REST service objects (Required)
├── Scripts/                             # Test scripts (Required)
│   ├── REST Assured/                    # Tests using REST Assured library
│   └── WS Keywords/                     # Tests using Katalon's WS Keywords
├── Test Cases/                          # Test case definitions (Required)
├── OpenAPI Specification/               # API specifications (Optional but useful)
├── Drivers/                             # External libraries and dependencies (Required)
├── Include/config/                      # Configuration files (Required)
├── Profiles/                            # Test execution profiles (Required)
├── build.gradle                         # Build configuration (Required)
├── katalon-api.prj                      # Project configuration (Required)
└── README.md                            # Project documentation (Recommended)

# Optional folders (can be removed or generated as needed):
├── Reports/                             # Test execution reports (Auto-generated)
├── Libs/                                # Generated libraries (Auto-generated)
├── bin/                                 # Compiled output (Auto-generated)
└── .gradle/                             # Gradle cache (Auto-generated)
```

### Essential Folders
These folders are required for the project to function properly:
- **Object Repository**: Contains REST service objects used by test scripts
- **Scripts**: Contains the actual test implementation code
- **Test Cases**: Contains test case definitions
- **Drivers**: Contains external libraries and dependencies
- **Include/config**: Contains configuration files
- **Profiles**: Contains test execution profiles
- **build.gradle**: Build configuration file
- **katalon-api.prj**: Project configuration file

### Optional Folders
These folders are either generated automatically or can be removed without affecting the core functionality:
- **Reports**: Generated during test execution, can be deleted and will be recreated
- **Libs**: Generated by Katalon Studio, can be regenerated
- **bin**: Contains compiled output, can be regenerated
- **.gradle**: Gradle cache, can be regenerated
- **OpenAPI Specification**: Useful for reference but not required for execution

## Technology Stack

- **Katalon Studio 10.2.x**: Test automation platform
- **REST Assured 3.3.0**: Java library for REST API testing
- **Groovy**: Scripting language for test implementation
- **Gradle**: Build automation

## Getting Started

### Prerequisites

- Katalon Studio 10.2.0 or later
- Java 8 or later
- Gradle (included via wrapper)

### Setup

1. Clone this repository
2. Run Gradle command to download dependencies:
   ```bash
   ./gradlew katalonCopyDependencies
   ```
3. Open the project in Katalon Studio

### Running Tests

#### Via Katalon Studio UI
1. Open the project in Katalon Studio
2. Navigate to Test Cases
3. Right-click on a test case and select "Run"

#### Via Command Line
```bash
./gradlew katalonRunTest -Dtestcase="REST Assured"
```

## Testing Approaches

### REST Assured Approach
REST Assured provides a domain-specific language for testing RESTful APIs. Here's a sample from our project:

```groovy
// Base URI for the Petstore API
RestAssured.baseURI = 'https://petstore.swagger.io/v2';

// Send a GET request to fetch available pets
Response findByStatusResponse = given()
    .queryParam("status", "available")
.when()
    .get("/pet/findByStatus");

// Parse the JSON response
def jsonResponse = new JsonSlurper().parseText(findByStatusResponse.asString());
```

### Katalon WS Keywords Approach
Katalon provides built-in keywords for API testing that use predefined test objects:

```groovy
// Send a GET request to the API using a test object from the Object Repository
def response = WS.sendRequest(findTestObject('Swagger Petstore/findPetsByStatus'))

// Parse the JSON response
def jsonResponse = new JsonSlurper().parseText(response.getResponseBodyContent())
```

## API Endpoints Tested

The project tests the following Swagger Petstore API endpoints:

### Pet Operations
- `POST /pet` - Add a new pet
- `PUT /pet` - Update an existing pet  
- `GET /pet/findByStatus` - Find pets by status
- `GET /pet/findByTags` - Find pets by tags
- `GET /pet/{petId}` - Find pet by ID
- `POST /pet/{petId}` - Update pet with form data
- `DELETE /pet/{petId}` - Delete a pet
- `POST /pet/{petId}/uploadImage` - Upload pet image

### Store Operations
- `GET /store/inventory` - Get pet inventories by status
- `POST /store/order` - Place an order for a pet
- `GET /store/order/{orderId}` - Find purchase order by ID
- `DELETE /store/order/{orderId}` - Delete purchase order by ID

### User Operations
- `POST /user` - Create user
- `POST /user/createWithArray` - Create list of users with array input
- `POST /user/createWithList` - Create list of users with list input
- `GET /user/login` - Log user into the system
- `GET /user/logout` - Log out current logged in user session
- `GET /user/{username}` - Get user by username
- `PUT /user/{username}` - Update user
- `DELETE /user/{username}` - Delete user

## Configuration

### Build Configuration
The project uses Gradle with the Katalon plugin. Key dependencies are configured in `build.gradle` with explicit Groovy exclusions to avoid conflicts with Katalon's embedded Groovy version:

```groovy
dependencies {
    // REST Assured Core Dependencies (excluding Groovy)
    implementation('io.rest-assured:rest-assured:3.3.0') {
        exclude group: 'org.apache.groovy', module: 'groovy'
        exclude group: 'org.apache.groovy', module: 'groovy-xml'
        exclude group: 'org.apache.groovy', module: 'groovy-json'
    }

    // JSON Schema Validation
    implementation('io.rest-assured:json-schema-validator:3.3.0') {
        exclude group: 'org.apache.groovy', module: 'groovy'
        exclude group: 'org.apache.groovy', module: 'groovy-json'
    }
}
```

### Logging
Logging configuration is available in `Include/config/log.properties`.

## Troubleshooting

### Common Issues

1. **Groovy Version Conflicts**
   - **Symptom**: ClassCastException or NoSuchMethodError related to Groovy classes
   - **Solution**: Ensure all REST Assured dependencies exclude Groovy as shown in the build.gradle file

2. **Connection Issues**
   - **Symptom**: Connection timeout or refused
   - **Solution**: Check network settings, proxy configuration, or try using a different endpoint URL

3. **JSON Parsing Errors**
   - **Symptom**: JsonSyntaxException or similar
   - **Solution**: Print and inspect the raw response to identify formatting issues

## Best Practices

1. **Use Object Repository for API Endpoints**
   - Store all API endpoints as test objects in the Object Repository
   - This allows for easier maintenance and reuse

2. **Implement Proper Assertions**
   - Always validate response status codes
   - Verify response body content with specific assertions
   - Check response headers when relevant

3. **Handle Authentication Properly**
   - Store credentials in Global Variables
   - Implement proper token management for OAuth flows

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Run tests to ensure they pass
5. Submit a pull request

## License

This project is for demonstration purposes.

## Additional Resources

- [REST Assured Documentation](https://rest-assured.io/)
- [Katalon API Testing Documentation](https://docs.katalon.com/katalon-studio/docs/webservice-test-object.html)
- [Swagger Petstore API Documentation](https://petstore.swagger.io/)
